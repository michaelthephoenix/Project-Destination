<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="/public/assests/mainPage.css"> -->
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="userPage1.css">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <title>Destination</title>

    <style>
        html,
        body,
        .my-map,
        #viewDiv {
            padding: 0;
            margin: 0;
            height: 100%;
            width: 100%;
        }

        .my-map {
            width: 80%;
        }
    </style>
    <link rel="stylesheet" href="https://js.arcgis.com/4.18/esri/themes/light/main.css" />
    <script src="https://js.arcgis.com/4.18/"></script>

    <script>

        require([
          "esri/config",
          "esri/Map",
          "esri/views/MapView",
          "esri/widgets/Locate",

          "esri/widgets/Track",
          "esri/Graphic"

        ], function(
            esriConfig,
            Map,
            MapView,
            Locate,

            Track,
            Graphic

        ) {

        esriConfig.apiKey = "AAPK5c881ee207a44444b20750dde3102a9fQ1fST75AWZplmPgHjyoweNraMqNmzaxJDQ_ir05XwJ4gOJvYwyDeUFn7p7IVzSVN";

        const map = new Map({
          basemap: "arcgis-navigation"
        });

        const view = new MapView({
          container: "viewDiv",
          map: map,
          center: [-40, 28],
          zoom: 2
        });

        const locate = new Locate({
          view: view,
          useHeadingEnabled: false,
          goToOverride: function(view, options) {
            options.target.scale = 1500;
            return view.goTo(options.target);
          }
        });
        view.ui.add(locate, "top-left");

      });
    </script>

</head>

<body>
    <div id="wrapper" class="animate">
        <nav class="navbar header-top fixed-top navbar-expand-lg navbar-dark bg-dark">
            <a class="navbar-brand" href="#">Destination</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText"
                aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
                <ul class="navbar-nav animate side-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#" title="Dashboard"><i class="fas fa-cube"></i> Dashboard <i
                                class="fas fa-cube shortmenu animate"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#trip-form-crud" title="Dashboard"><i class="fas fa-bus"></i> Add Trip <i
                                class="fas fa-bus shortmenu animate"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" title=""><i class="fas fa-truck"></i> Deliveries <i
                                class="fas fa-truck shortmenu animate"></i></a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="#viewDiv" title="Trips in progress"><i class="fas fa-rocket"></i> On
                            going trips <i class="fas fa-rocket shortmenu animate"></i></a>
                    </li>
                </ul>
                <ul class="navbar-nav ml-md-auto d-md-flex">

                    <li class="nav-item">
                        <a class="nav-link" href="mainPage.html"><i class="fas fa-key"></i> Logout</a>
                    </li>
                </ul>
            </div>
        </nav>
        <div class="container-fluid" id="tripDetails">
            <div class="row">
                <div class="col">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Kampala to Nairobi</h5>
                            <h6 class="card-subtitle mb-2 text-muted">Departure: 11:00AM Duration: 12 hrs</h6>
                            <p class="card-text">Due to the covid pandemic Passengers are reminded to carry there of the
                                trip</p>
                            <a href="#" class="card-link">Edit</a>
                            <a href="#" class="card-link">Delete</a>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Kampala to Hoima</h5>
                            <h6 class="card-subtitle mb-2 text-muted">Departure: 11:00AM Duration: 6 hrs </h6>
                            <p class="card-text">Due to the covid pandemic Passengers are reminded to carry there of the
                                trip</p>
                            <a href="#" class="card-link">Edit</a>
                            <a href="#" class="card-link">Delete</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Passenger List</h5>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">First</th>
                                        <th scope="col">Last</th>
                                        <th scope="col">Handle</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th scope="row">1</th>
                                        <td>Mark</td>
                                        <td>Otto</td>
                                        <td>@mdo</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">2</th>
                                        <td>Jacob</td>
                                        <td>Thornton</td>
                                        <td>@fat</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">3</th>
                                        <td>Larry</td>
                                        <td>the Bird</td>
                                        <td>@twitter</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Passenger List</h5>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">First</th>
                                        <th scope="col">Last</th>
                                        <th scope="col">Handle</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <th scope="row">1</th>
                                        <td>Mark</td>
                                        <td>Otto</td>
                                        <td>@mdo</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">2</th>
                                        <td>Jacob</td>
                                        <td>Thornton</td>
                                        <td>@fat</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">3</th>
                                        <td>Larry</td>
                                        <td>the Bird</td>
                                        <td>@twitter</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    </div>
    <div class="card" id="trip-form-crud" style="margin: 10%;">
        <table>
            <tr>
                <td>
                    <!--HTML form for crud operation-->
                    <form autocomplete="off" onsubmit="onFormSubmit()">
                        <div>
                            <label for="fullName">Trip Name</label>
                            <input type="text" name="fullName" id="fullName" >
                        </div>
                        <div>
                            <label for="empCode">Trip Duration</label>
                            <input type="text" name="empCode" id="empCode" >
                        </div>
                        <div>
                            <label for="salary">Bus Fare</label> </br>
                            <input type="text" name="salary" id="salary">
                        </div>
                        <div>
                            <label for="city">Time of Depture</label> </br>
                            <input type="text" name="city" id="city">
                        </div>
                        <div class="form_action--button">
                            <input type="submit" value="Submit">
                            <input type="reset" value="Reset">
                        </div>
                    </form>
                </td>
                <td>
                    <table class="list" id="employeeList">
                        <thead>
                            <tr>
                                <th>Trip Name</th>
                                <th>Trip Duration</th>
                                <th>Bus Fare</th>
                                <th>Time of Depture</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
     
                        </tbody>
                    </table>
                </td>
            </tr>
        </table>

    </div>

    <div class="card my-map mx-auto">
        <div id="viewDiv"></div>
    </div>


    <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
    <script>
         var selectedRow = null;
function onFormSubmit(e){
    event.preventDefault();
    var formData = readFormData();
    if(selectedRow === null){
        insertNewRecord(formData);
    }else{
        updateRecord(formData)
    }
    resetForm();
    }
// Read operation using this function
function readFormData(){
    var formData = {};
    formData["fullName"] = document.getElementById("fullName").value;
    formData["empCode"] = document.getElementById("empCode").value;
    formData["salary"] = document.getElementById("salary").value;
    formData["city"] = document.getElementById("city").value;
    return formData;
}
 
// Create operation
function insertNewRecord(data){
    var table = document.getElementById("employeeList").getElementsByTagName('tbody')[0];
    var newRow = table.insertRow(table.length);
    var cell1 = newRow.insertCell(0);
        cell1.innerHTML = data.fullName;
    var cell2 = newRow.insertCell(1);
        cell2.innerHTML = data.empCode;
    var cell3 = newRow.insertCell(2);
        cell3.innerHTML = data.salary;
    var cell4 = newRow.insertCell(3);
        cell4.innerHTML = data.city;
    var cell5 = newRow.insertCell(4);
        cell5.innerHTML = `<a href="#" onClick='onEdit(this)'>Edit</a>
                        <a href="#" onClick='onDelete(this)'>Delete</a>`;
}
 
// To Reset the data of fill input
function resetForm(){
    document.getElementById('fullName').value = '';
    document.getElementById('empCode').value = '';
    document.getElementById('salary').value = '';
    document.getElementById('city').value = '';
    selectedRow = null;
}
 
// For Edit operation
function onEdit(td){
    selectedRow = td.parentElement.parentElement;
    document.getElementById('fullName').value = selectedRow.cells[0].innerHTML;
    document.getElementById('empCode').value = selectedRow.cells[1].innerHTML;
    document.getElementById('salary').value = selectedRow.cells[2].innerHTML;
    document.getElementById('city').value = selectedRow.cells[3].innerHTML;
}
function updateRecord(formData){
    selectedRow.cells[0].innerHTML = formData.fullName;
    selectedRow.cells[1].innerHTML = formData.empCode;
    selectedRow.cells[2].innerHTML = formData.salary;
    selectedRow.cells[3].innerHTML = formData.city;
}
function onDelete(td){
    if(confirm('Are you sure you want to delete this record?')){
        row = td.parentElement.parentElement;
        document.getElementById('employeeList').deleteRow(row.rowIndex);
        resetForm();
    }    
}

    </script>
</body>

</html>